# QA Automation Loop

Automated QA testing loop that spawns multiple unbiased beta tester profiles, consolidates feedback, and creates GitHub issues for discovered bugs.

## Usage

```
/qa-automation-loop [options]
```

## Options

- `--profiles <list>` - Specific profiles to run (comma-separated)
- `--dry-run` - Run without creating issues
- `--verbose` - Show detailed output

## Process

### 1. Initialize

Load configuration from `.claude/automation/config/qa_profiles.yaml`:

```yaml
profiles:
  - power_user      # Expert CLI user
  - beginner        # New developer
  - security_researcher  # Security-focused
  - devops_engineer     # DevOps/SRE
```

### 2. Spawn Profiles (Parallel)

For each profile, spawn a `/unbiased-beta-tester` agent:

```
/unbiased-beta-tester profile=power_user

Expected behavior:
- Acts as specified persona
- Tests CLI functionality
- Reports findings in structured format
```

### 3. Collect Results

Each profile returns findings in format:

```yaml
findings:
  - type: bug|ux|performance|security
    severity: critical|high|medium|low
    title: "Brief description"
    reproduction:
      - step 1
      - step 2
    expected: "Expected behavior"
    actual: "Actual behavior"
    command_output: |
      <output>
```

### 4. Consolidate

- Deduplicate similar findings
- Merge findings from different profiles
- Categorize by severity and type
- Check for existing issues

### 5. Create Issues

For each unique finding, create GitHub issue:

```bash
gh issue create \
  --title "[QA] ${title}" \
  --label "qa,${severity},${type}" \
  --body "${body}"
```

Issue body template:
```markdown
## QA Finding

**Discovered by**: QA Automation Loop
**Profile**: ${profile}
**Severity**: ${severity}

### Description
${description}

### Reproduction Steps
${steps}

### Expected vs Actual
- **Expected**: ${expected}
- **Actual**: ${actual}

### Command Output
```
${output}
```

---
*Auto-generated by QA Automation Loop*
```

### 6. Report

Generate run report at `.claude/automation/state/qa_runs/{run_id}.yaml`

## Example Session

```
> /qa-automation-loop

QA Automation Loop Starting...
Time: 2026-01-11 09:00:00 PST

[1/4] Spawning profile: power_user
[2/4] Spawning profile: beginner
[3/4] Spawning profile: security_researcher
[4/4] Spawning profile: devops_engineer

Waiting for profiles to complete...

Profile Results:
  power_user:          ✓ 45 tests, 2 findings
  beginner:            ✓ 30 tests, 1 finding
  security_researcher: ✓ 25 tests, 0 findings
  devops_engineer:     ✓ 35 tests, 1 finding

Consolidating findings...
  Raw findings: 4
  After dedup:  3

Creating issues...
  [#1234] [QA] Unexpected output for pipe commands (medium)
  [#1235] [QA] Confusing error for invalid syntax (low)
  [#1236] [QA] Missing help for advanced flags (low)

QA Automation Loop Complete
  Duration: 5m 23s
  Pass rate: 96.7%
  Issues created: 3
```

## Configuration

### Profile Definitions

Edit `.claude/automation/config/qa_profiles.yaml`:

```yaml
profiles:
  - name: "power_user"
    description: "Expert CLI user"
    test_categories:
      - complex_commands
      - edge_cases
      - performance

  - name: "custom_profile"
    description: "Your custom profile"
    test_categories:
      - specific_feature
```

### Loop Settings

Edit `.claude/automation/config/qa_loop.yaml`:

```yaml
qa_loop:
  enabled: true
  schedule: "0 9 * * *"

  profiles:
    - power_user
    - beginner

  issue_creation:
    enabled: true
    check_duplicates: true
```

## Integration

- **Input**: Configuration, previous run state
- **Output**: GitHub issues, run report, metrics
- **Triggers**: Scheduled (daily 9 AM), manual
- **Feeds into**: Dev Loop (via created issues)

## Related

- `/unbiased-beta-tester` - Individual tester skill
- `/qa-bundle-validation` - Multi-profile testing
- [QA_LOOP_DRS.md](../.claude/automation/specs/QA_LOOP_DRS.md)
