# v1.1.0-beta Incident Response & Rollback Plan

**Purpose**: Define procedures for handling critical issues during and after beta release
**Scope**: v1.1.0-beta release (Jan 24, 2026)
**Owner**: Release Manager
**Last Updated**: January 8, 2026

---

## Severity Levels

### P0 - Critical (Immediate Response Required)
**Definition**: System-breaking issues affecting security, privacy, or data integrity

**Examples**:
- Privacy leak: PII found in telemetry data
- Security vulnerability: Remote code execution, privilege escalation
- Data loss: User data corrupted or deleted
- Complete system failure: Binary crashes on startup for all users
- Supply chain compromise: Malicious code in dependencies

**Response Time**: Immediate (within 1 hour)
**Communication**: Public advisory within 2 hours
**Resolution Target**: Within 24 hours

### P1 - High Priority (Urgent Response)
**Definition**: Major functionality broken for significant portion of users

**Examples**:
- Command generation completely broken
- Installation fails on major platform (macOS/Linux)
- Telemetry causing system instability
- Safety validation not working (dangerous commands passing through)
- Backend integration completely failing

**Response Time**: Within 4 hours
**Communication**: Status update within 8 hours
**Resolution Target**: Within 3 days

### P2 - Medium Priority (Important)
**Definition**: Significant issues affecting user experience but workarounds exist

**Examples**:
- Command generation accuracy significantly degraded
- Installation difficult but possible with manual steps
- Performance significantly worse than v1.0.4
- Error messages confusing or misleading
- Documentation inaccuracies causing problems

**Response Time**: Within 24 hours
**Communication**: Acknowledged in GitHub Issues
**Resolution Target**: Within 1 week (can defer to v1.1.1)

### P3 - Low Priority (Minor)
**Definition**: Minor issues or enhancements

**Examples**:
- Cosmetic bugs
- Minor performance improvements
- Feature requests
- Documentation improvements
- Edge case bugs with minimal impact

**Response Time**: Within 1 week
**Communication**: GitHub Issues
**Resolution Target**: Next release (v1.1.1 or later)

---

## Incident Response Workflow

### Phase 1: Detection & Assessment (0-1 hour)

#### Detection Sources
- [ ] Beta tester reports (email, GitHub Issues)
- [ ] Telemetry anomalies (error spikes, crash reports)
- [ ] Security vulnerability disclosure
- [ ] Automated monitoring alerts (if available)
- [ ] Social media mentions
- [ ] Community reports (Discord, Discussions)

#### Initial Assessment
1. **Verify the report** (5-10 minutes)
   - Reproduce the issue locally
   - Confirm severity and scope
   - Check if it affects beta only or all versions

2. **Classify severity** (5 minutes)
   - Assign P0/P1/P2/P3 level
   - Determine user impact (% affected)
   - Assess data/security risk

3. **Activate response team** (10 minutes)
   - Notify Release Manager
   - Alert relevant developers
   - Assign incident commander

4. **Create incident document** (10 minutes)
   - GitHub Issue (private if security)
   - Internal tracking document
   - Timeline log started

### Phase 2: Immediate Mitigation (1-4 hours)

#### For P0 (Critical) Incidents

**Option 1: Emergency Yank (Nuclear Option)**
```bash
# Immediately remove from crates.io
cargo yank --vers 1.1.0-beta caro

# Update GitHub release to mark as YANKED
gh release edit v1.1.0-beta --notes "⚠️ YANKED due to [issue]"

# Post public advisory
gh issue create --title "SECURITY ADVISORY: v1.1.0-beta yanked" --label security
```

**Timeline**: Execute within 1 hour of P0 confirmation

**Option 2: Disable Telemetry Backend (If PII Leak)**
```bash
# Immediately shut down telemetry ingest service
# (Prevents new data collection)
curl -X POST https://telemetry.caro.sh/emergency-shutdown

# Quarantine collected data
# (Prevents data from being processed/viewed)
```

**Timeline**: Execute within 30 minutes of PII leak confirmation

**Option 3: Binary Distribution Removal**
```bash
# Remove binary install script (if binary-specific issue)
# Update caro.sh/install.sh to skip v1.1.0-beta

# Update GitHub release binary attachments
gh release delete-asset v1.1.0-beta [binary-name]
```

**Timeline**: Execute within 2 hours if binary-specific

#### For P1 (High Priority) Incidents

**Option 1: Hotfix Release (v1.1.0-beta.1)**
1. Create hotfix branch from v1.1.0-beta tag
2. Apply minimal fix
3. Test fix thoroughly
4. Release v1.1.0-beta.1 (yank v1.1.0-beta)
5. Update announcement with fix details

**Timeline**: Within 24 hours

**Option 2: Workaround Documentation**
1. Document workaround in GitHub Issue
2. Update release notes with workaround
3. Pin GitHub Issue to top
4. Email beta testers with workaround
5. Plan fix for v1.1.1

**Timeline**: Within 4 hours

#### Communication Templates

**P0 Public Advisory (post within 2 hours)**:
```markdown
# SECURITY ADVISORY: Caro v1.1.0-beta

**Severity**: Critical
**Affected Versions**: v1.1.0-beta only
**Status**: YANKED from crates.io
**Published**: [Date/Time]

## Summary
[Brief description of the issue]

## Impact
[What users are affected and how]

## Immediate Action Required
- Do NOT install v1.1.0-beta
- If already installed, downgrade to v1.0.4:
  ```bash
  cargo install caro --version 1.0.4 --force
  ```
- [Additional actions if needed]

## Details
[Technical details of the vulnerability/issue]

## Timeline
- [Time]: Issue reported
- [Time]: Confirmed and severity assessed
- [Time]: Version yanked from crates.io
- [Time]: This advisory published

## Resolution
[Fix plan and timeline]

## Contact
For questions: security@caro.sh
```

**P1 Status Update (post within 8 hours)**:
```markdown
# Issue Update: [Brief Title]

**Severity**: High Priority (P1)
**Affected Versions**: v1.1.0-beta
**Status**: Investigating / Fix in progress / Resolved
**Updated**: [Date/Time]

## Summary
[What's broken and who's affected]

## Workaround
[If available, provide immediate workaround]

## Our Plan
[What we're doing to fix it]

## Timeline
- [Time]: Issue reported
- [Time]: Confirmed
- [Time]: Workaround documented (if applicable)
- [ETA]: Fix expected

## Updates
We'll update this issue as we make progress.
```

### Phase 3: Root Cause Analysis (4-24 hours)

#### Investigation Steps
1. **Reproduce consistently** (1-2 hours)
   - Create minimal reproduction case
   - Document exact steps
   - Test on multiple platforms

2. **Identify root cause** (2-4 hours)
   - Review relevant code
   - Check recent changes (git blame, PRs)
   - Examine related systems

3. **Assess full scope** (1-2 hours)
   - What else might be affected?
   - Are there similar issues elsewhere?
   - What's the blast radius?

4. **Document findings** (1 hour)
   - Technical analysis in GitHub Issue
   - Add to incident timeline
   - Update internal team

### Phase 4: Fix Development (varies by severity)

#### P0 Fix Process
1. **Develop minimal fix** (2-6 hours)
   - Focus on smallest change that resolves issue
   - Don't refactor or improve unrelated code
   - Add regression test

2. **Peer review** (1 hour)
   - At least 2 reviewers for P0
   - Security review if applicable
   - Verify fix doesn't introduce new issues

3. **Test thoroughly** (2-4 hours)
   - Unit tests
   - Integration tests
   - Manual testing on affected platforms
   - Verify fix with original reporter

4. **Prepare release** (1 hour)
   - Update CHANGELOG.md
   - Create release notes
   - Tag version

**Total P0 fix timeline target**: 8-12 hours

#### P1 Fix Process
Similar to P0 but with more time:
- Development: 4-12 hours
- Review: 2 hours (1 reviewer acceptable)
- Testing: 4-8 hours
- Release prep: 1-2 hours

**Total P1 fix timeline target**: 24-48 hours

### Phase 5: Release & Verification (1-2 hours)

#### Hotfix Release Steps
1. **Create hotfix tag** (5 minutes)
   ```bash
   git tag -a v1.1.0-beta.1 -m "Hotfix: [issue description]"
   git push origin v1.1.0-beta.1
   ```

2. **Yank broken version** (5 minutes)
   ```bash
   cargo yank --vers 1.1.0-beta caro
   ```

3. **Publish hotfix** (10 minutes)
   ```bash
   cargo publish
   ```

4. **Update GitHub release** (10 minutes)
   ```bash
   gh release create v1.1.0-beta.1 --title "v1.1.0-beta.1 Hotfix" --notes "[notes]"
   ```

5. **Verify hotfix works** (30 minutes)
   - Install on clean system
   - Reproduce original issue (should be fixed)
   - Test critical paths
   - Confirm with original reporter

6. **Announce hotfix** (15 minutes)
   - Update advisory/status issue
   - Email beta testers
   - Post to social media
   - Update documentation

### Phase 6: Post-Incident Review (1-2 days after)

#### Review Meeting
**Attendees**: Release Manager, developers involved, QA

**Agenda**:
1. Incident timeline review (15 min)
2. What went well (10 min)
3. What went poorly (15 min)
4. Root cause deep dive (20 min)
5. Prevention strategies (20 min)
6. Action items (10 min)

#### Post-Incident Report Template
See `.claude/releases/v1.1.0-beta-retrospective-template.md` - add incident section

---

## Rollback Procedures

### Scenario 1: Complete Rollback (Cancel Release)

**When to use**: P0 discovered within 24 hours, no viable hotfix in short time

**Steps**:
1. **Yank from crates.io** (immediate)
   ```bash
   cargo yank --vers 1.1.0-beta caro
   ```

2. **Remove GitHub release** (immediate)
   ```bash
   gh release delete v1.1.0-beta --yes
   ```

3. **Update binary install script** (within 1 hour)
   - Modify caro.sh/install.sh to skip v1.1.0-beta
   - Default to v1.0.4 (last stable)

4. **Public announcement** (within 2 hours)
   ```markdown
   # v1.1.0-beta Release Cancelled

   We've discovered a critical issue in v1.1.0-beta and have cancelled the release.

   ## Action Required
   If you installed v1.1.0-beta:
   - Downgrade to v1.0.4: `cargo install caro --version 1.0.4 --force`

   ## What Happened
   [Brief explanation]

   ## What's Next
   - We're working on a fix
   - New beta release: [date estimate]
   - v1.1.0 GA delayed to [date]

   We apologize for the inconvenience.
   ```

5. **Notify beta testers directly** (within 2 hours)
   - Email all beta testers
   - Provide downgrade instructions
   - Explain situation transparently

6. **Delay GA release**
   - Update ROADMAP.md with new dates
   - Update v1.1.0-beta-status.md
   - Communicate delay reasoning

### Scenario 2: Partial Rollback (Feature Disable)

**When to use**: Specific feature causing issues, rest of release is solid

**Steps**:
1. **Create hotfix branch**
   ```bash
   git checkout -b hotfix/disable-telemetry v1.1.0-beta
   ```

2. **Disable problematic feature**
   - For telemetry: Default to `enabled = false` in config
   - Remove first-run consent prompt
   - Keep CLI commands but no-op

3. **Release v1.1.0-beta.1**
   - Publish with feature disabled
   - Document in release notes
   - Plan re-enable for v1.1.1

**Example: Disable Telemetry**:
```rust
// In src/telemetry/mod.rs
pub fn init() -> Result<()> {
    // Temporarily disabled due to [issue]
    log::warn!("Telemetry disabled in v1.1.0-beta.1");
    Ok(())
}
```

### Scenario 3: Data Remediation (Privacy Leak)

**When to use**: PII accidentally collected in telemetry

**Immediate Steps** (within 1 hour):
1. **Shut down telemetry backend**
   - Stop accepting new data
   - Quarantine all collected data

2. **Notify affected users** (email all beta testers)
   ```markdown
   Subject: URGENT: Caro v1.1.0-beta Privacy Incident

   We've discovered that v1.1.0-beta inadvertently collected [type of PII].

   ## Immediate Actions Taken
   - Telemetry backend shut down
   - All collected data quarantined
   - Version yanked from distribution

   ## Your Data
   [Specific details about what was collected from them]

   ## What We're Doing
   - Deleting all affected data
   - Fixing the validation issue
   - Conducting security audit

   ## What You Can Do
   - Delete local telemetry: `caro telemetry clear`
   - Downgrade: `cargo install caro --version 1.0.4 --force`

   We deeply apologize. Privacy is our top priority.

   Contact: security@caro.sh
   ```

3. **Data deletion** (within 4 hours)
   - Delete ALL collected telemetry data
   - Verify deletion with checksums/logs
   - Document deletion process

4. **Security audit** (within 24 hours)
   - External security review of validation code
   - Comprehensive test coverage
   - Penetration testing of collection

5. **Transparency report** (within 1 week)
   - What was collected (exact fields)
   - How many users affected
   - What data was accessed (none, ideally)
   - How we fixed it
   - How we'll prevent it

---

## Communication Protocols

### Internal Communication

**During Incident**:
- **Slack/Discord** (if exists): #incidents channel
- **Email Thread**: incidents@caro.sh
- **GitHub Private Issue**: For security incidents
- **Status Doc**: Shared Google Doc for timeline

**Response Times**:
- Release Manager: 1 hour max
- Core Developer: 2 hours max
- Documentation: 4 hours max

### External Communication

**Transparency Principles**:
1. ✅ **Be honest**: Don't downplay or hide issues
2. ✅ **Be timely**: Communicate as soon as we know
3. ✅ **Be helpful**: Provide actionable steps
4. ✅ **Be accountable**: Own the problem
5. ✅ **Be clear**: Avoid jargon, be specific

**Channels** (in order of priority):
1. **GitHub Issue** (public, for P1+)
2. **GitHub Release** (update notes for all issues)
3. **Email** (beta testers for P0/P1)
4. **GitHub Discussions** (general announcements)
5. **Social Media** (for widespread P0 issues)
6. **Blog Post** (for major incidents requiring explanation)

**What to Communicate**:
- What happened (facts)
- Who is affected
- What we're doing about it
- What users should do
- When we'll have an update
- How to get help

**What NOT to Communicate**:
- Speculation or unconfirmed information
- Blaming individuals or teams
- Defensive or dismissive language
- Technical jargon without explanation

---

## Testing Verification Matrix

**Before releasing hotfix, verify**:

### Critical Path Testing
- [ ] Installation works (cargo install)
- [ ] Binary install script works
- [ ] First-run experience works
- [ ] Basic command generation works
- [ ] Help commands work
- [ ] Version display works

### Platform Testing
- [ ] macOS Apple Silicon
- [ ] macOS Intel
- [ ] Linux x86_64
- [ ] Linux ARM64

### Regression Testing
- [ ] Original issue is fixed
- [ ] No new issues introduced
- [ ] All existing tests pass
- [ ] Integration tests pass

### User Acceptance
- [ ] Original reporter confirms fix
- [ ] At least 1 beta tester confirms

---

## Incident Response Team Roles

### Incident Commander (Release Manager)
**Responsibilities**:
- Overall coordination
- Severity assessment
- Communication decisions
- Go/no-go decisions

**Contact**: [Release Manager Email/Phone]

### Technical Lead
**Responsibilities**:
- Root cause analysis
- Fix development
- Code review
- Technical decisions

**Contact**: [Tech Lead Email/Phone]

### Communications Lead
**Responsibilities**:
- Public communications
- Beta tester notifications
- Social media updates
- Documentation updates

**Contact**: [Comms Lead Email/Phone]

### QA Lead (if available)
**Responsibilities**:
- Reproduction verification
- Hotfix testing
- Regression testing
- User acceptance testing

**Contact**: [QA Lead Email/Phone]

---

## Escalation Paths

### When to Escalate

**To Project Lead**:
- P0 incident confirmed
- Requires legal/PR guidance
- Potential reputational damage
- Multi-week delay to GA required

**To Security Team/External Experts**:
- Security vulnerability (CVE worthy)
- Cryptographic issue
- Supply chain compromise
- Need external security audit

**To Legal**:
- Privacy violation (GDPR/CCPA)
- Potential liability
- Third-party claims
- Compliance issues

---

## Post-Incident Actions

### Immediate (Day 1)
- [ ] Update incident timeline document
- [ ] Verify fix deployed successfully
- [ ] Monitor for recurrence
- [ ] Thank responders and reporters

### Short-term (Week 1)
- [ ] Conduct post-incident review meeting
- [ ] Document lessons learned
- [ ] Create action items for prevention
- [ ] Update runbooks/procedures

### Medium-term (Week 2-4)
- [ ] Implement preventative measures
- [ ] Add regression tests
- [ ] Update monitoring/alerting
- [ ] Improve documentation

### Long-term (Month 1-3)
- [ ] Share learnings with community (blog post)
- [ ] Improve processes based on incident
- [ ] Train team on new procedures
- [ ] Review and update this plan

---

## Appendix: Command Reference

### Emergency Commands

**Yank from crates.io**:
```bash
cargo yank --vers 1.1.0-beta caro
cargo yank --vers 1.1.0-beta.1 caro  # if hotfix also bad
```

**Delete GitHub Release**:
```bash
gh release delete v1.1.0-beta --yes
```

**Check who installed beta**:
```bash
# From telemetry database (if we have it)
sqlite3 telemetry.db "SELECT COUNT(DISTINCT session_id) FROM sessions WHERE version='1.1.0-beta'"
```

**User downgrade command** (for announcements):
```bash
cargo install caro --version 1.0.4 --force
```

**Hotfix tag and release**:
```bash
git tag -a v1.1.0-beta.1 -m "Hotfix: [description]"
git push origin v1.1.0-beta.1
cargo publish
gh release create v1.1.0-beta.1 --title "v1.1.0-beta.1 Hotfix" --notes "[notes]"
```

---

## Contact Information

**Emergency Contacts**:
- Release Manager: [Email/Phone]
- Tech Lead: [Email/Phone]
- Security: security@caro.sh
- General: beta@caro.sh

**External Resources**:
- GitHub Security Advisory: https://github.com/wildcard/caro/security/advisories
- crates.io Support: help@crates.io
- Rust Security Team: security@rust-lang.org (for supply chain issues)

---

**Document Version**: 1.0
**Last Updated**: January 8, 2026
**Next Review**: After any incident, or before v1.1.0 GA
**Owner**: Release Manager

---

## Testing This Plan

**Tabletop Exercise** (recommended before release):
1. Simulate P0 privacy leak scenario
2. Walk through response steps
3. Time each phase
4. Identify gaps or unclear steps
5. Update plan based on findings

**Schedule**: January 20, 2026 (before release)
