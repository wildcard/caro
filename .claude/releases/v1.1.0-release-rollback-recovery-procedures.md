# Release Rollback & Recovery Procedures

**Version**: 1.0
**Last Updated**: 2026-01-08
**Owner**: Engineering Lead + Release Manager
**Status**: Active

---

## Document Purpose

This document defines comprehensive rollback and recovery procedures for the v1.1.0-beta release. It establishes decision criteria for rollbacks, step-by-step procedures for reverting to previous versions, data recovery strategies, and system restoration processes to minimize user impact when issues arise.

**Audience**: Release Manager, Engineering Lead, On-Call Engineers, SRE Team

**Related Documents**:
- `v1.1.0-release-runbook-sop.md` - Release execution procedures
- `v1.1.0-crisis-management-emergency-response.md` - Crisis response framework
- `v1.1.0-release-automation-cicd-pipeline.md` - Deployment automation
- `v1.1.0-progressive-rollout-strategy.md` - Rollout strategy

---

## Table of Contents

1. [Rollback Philosophy](#rollback-philosophy)
2. [Rollback Decision Criteria](#rollback-decision-criteria)
3. [Rollback Procedures](#rollback-procedures)
4. [Recovery Scenarios](#recovery-scenarios)
5. [Data Recovery](#data-recovery)
6. [Communication During Rollback](#communication-during-rollback)
7. [Post-Rollback Analysis](#post-rollback-analysis)
8. [Prevention Strategies](#prevention-strategies)

---

## Rollback Philosophy

### Core Principles

**1. User Safety First**
- Protect users from broken functionality
- Prefer working old version over broken new version
- Fast rollback > perfect fix (fix forward later)

**2. Minimize Downtime**
- Rollback should be faster than fixing forward
- Automated rollback procedures (not manual)
- Practice rollback in staging (not first time in prod)

**3. Preserve User Data**
- Never lose user configurations or telemetry data
- Backward-compatible data formats
- Graceful degradation when old version reads new data

**4. Clear Decision Making**
- Predefined rollback criteria (not subjective)
- Single decision maker (Release Manager)
- Document decision rationale

**5. Learn from Failures**
- Every rollback triggers post-mortem
- Update rollback procedures based on learnings
- Share knowledge with team

---

## Rollback Decision Criteria

### When to Rollback (GO BACK)

**Automatic Rollback Triggers** (no human decision needed):

| Trigger | Threshold | Auto-Rollback? | Example |
|---------|-----------|----------------|---------|
| **Critical Bugs (P0)** | â‰¥1 within 1 hour | âœ… Yes | Data loss, security vulnerability, crashes on startup |
| **High Severity Bugs (P1)** | â‰¥5 within 6 hours | âœ… Yes | Safety validation bypass, persistent crashes, major features broken |
| **Success Rate Drop** | <70% (vs 86.2% baseline) | âœ… Yes | Command generation fails for >30% of queries |
| **Crash Rate Spike** | >10% of users | âœ… Yes | Widespread crashes across platforms |
| **Security Incident** | Any severity | âœ… Yes | Privacy breach, command injection, privilege escalation |

**Manual Rollback Triggers** (Release Manager decides):

| Trigger | Threshold | Guidance | Example |
|---------|-----------|----------|---------|
| **Medium Bugs (P2)** | â‰¥10 within 24 hours | Consider rollback if affecting core workflows | Static matcher regression, slow performance |
| **User Complaints** | â‰¥50 negative reports | Rollback if sentiment overwhelmingly negative | "The new version is unusable", "I'm switching back" |
| **Adoption Stall** | <50% of target AWU | Rollback if users actively avoiding upgrade | Users staying on v1.0.0 despite prompts |
| **Platform-Specific Issues** | Broken on 1+ platform | Rollback if critical platform (macOS Intel, Linux x86_64) affected | macOS ARM works but Intel crashes |

---

### When NOT to Rollback (FIX FORWARD)

**Scenarios where fixing forward is better**:

âœ… **Minor bugs (P3)** that don't block core functionality
- Example: Typo in help text, color rendering issue
- Action: Fix in next patch release (v1.1.1)

âœ… **Edge cases** affecting <5% of users with workaround
- Example: Ollama backend timeout for specific models
- Action: Document workaround, fix in v1.1.1

âœ… **Missing features** (not regressions)
- Example: Users request Docker command patterns
- Action: Add to backlog for v1.2.0

âœ… **Configuration issues** (user error)
- Example: User set invalid Ollama URL
- Action: Improve error messages, update docs

âœ… **Easy quick fix** (<1 hour to implement and deploy)
- Example: Off-by-one error in static matcher
- Action: Hotfix release (v1.1.1) within 1 hour

---

### Rollback Decision Tree

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Issue Detected                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ P0/Security?â”‚â”€â”€â”€ YES â”€â”€â–¶ IMMEDIATE ROLLBACK
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
               â”‚ NO
               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ P1 or Auto      â”‚â”€â”€â”€ YES â”€â”€â–¶ AUTOMATIC ROLLBACK
        â”‚ Trigger Met?    â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ NO
               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Can Fix in      â”‚â”€â”€â”€ YES â”€â”€â–¶ FIX FORWARD
        â”‚ <1 hour?        â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ NO
               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Affects core    â”‚â”€â”€â”€ YES â”€â”€â–¶ ROLLBACK
        â”‚ functionality?  â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ NO
               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ >50 user        â”‚â”€â”€â”€ YES â”€â”€â–¶ ROLLBACK
        â”‚ complaints?     â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ NO
               â–¼
        FIX FORWARD (v1.1.1 or v1.2.0)
```

---

## Rollback Procedures

### Pre-Rollback Checklist (5 Minutes)

**Before initiating rollback, confirm**:

```markdown
## Pre-Rollback Checklist

- [ ] **Decision documented**: Why are we rolling back? (link to incident)
- [ ] **Stakeholders notified**: Release Manager, Engineering Lead, Community Lead
- [ ] **Users warned**: Discord announcement (if time permits)
- [ ] **Rollback artifacts ready**: v1.0.0 binaries, checksums, release notes
- [ ] **Team available**: At least 2 engineers online for support
- [ ] **Communication channels ready**: Discord #announcements, Twitter, GitHub

**Decision Authority**: Release Manager [Name]
**Timestamp**: [ISO 8601]
**Reason**: [Brief description]

Proceed? âœ… YES / âŒ ABORT
```

---

### Rollback Procedure: GitHub Releases (Primary Distribution)

**Estimated Time**: 10-15 minutes

**Step 1: Create Rollback Announcement (2 min)**

```bash
# Draft rollback announcement
cat > rollback-announcement.md <<'EOF'
âš ï¸ **ROLLBACK NOTICE: Reverting to v1.0.0**

We've identified critical issues in v1.1.0-beta:
- [Brief description of issue]

We're rolling back to v1.0.0 to ensure stability.

**Action Required**:
- If you upgraded to v1.1.0-beta, please downgrade:
  ```
  curl -fsSL https://caro.sh/install.sh | sh -s -- --version v1.0.0
  ```
- Or manually download: https://github.com/username/caro/releases/tag/v1.0.0

We'll provide an update within 24 hours.

Apologies for the disruption.
EOF
```

**Step 2: Un-Latest v1.1.0 Release on GitHub (2 min)**

```bash
# Use GitHub CLI
gh release edit v1.1.0-beta \
  --draft \
  --title "v1.1.0-beta (ROLLED BACK - DO NOT USE)"

# Add rollback warning to release notes
gh release edit v1.1.0-beta \
  --notes "âš ï¸ **THIS RELEASE HAS BEEN ROLLED BACK DUE TO CRITICAL ISSUES. DO NOT INSTALL.**

Please use v1.0.0 instead: https://github.com/username/caro/releases/tag/v1.0.0

See rollback announcement: [link]"
```

**Step 3: Mark v1.0.0 as Latest (2 min)**

```bash
# Set v1.0.0 as the latest release
gh release edit v1.0.0 \
  --latest \
  --title "v1.0.0 (STABLE - RECOMMENDED)"
```

**Step 4: Update install.sh Script (2 min)**

```bash
# Edit install.sh to default to v1.0.0
sed -i 's/VERSION=v1.1.0-beta/VERSION=v1.0.0/' install.sh

# Commit and push
git add install.sh
git commit -m "chore: rollback install script to v1.0.0"
git push origin main
```

**Step 5: Announce Rollback (2 min)**

Post `rollback-announcement.md` to:
- Discord #announcements (pin the message)
- Twitter/X (thread)
- GitHub Discussions (sticky post)
- Email mailing list (if time permits)

**Step 6: Monitor Rollback (30 min - 1 hour)**

```bash
# Monitor Discord for user feedback
# Watch for:
# - Users confirming successful downgrade
# - Users still experiencing issues (might be on cached v1.1.0)
# - Questions about how to rollback

# Check GitHub release stats
gh api /repos/:owner/:repo/releases/:id --jq '.download_count'
# Expect: v1.0.0 downloads increasing
```

**Step 7: Verify Rollback Success (1 hour later)**

```markdown
## Rollback Success Criteria

- [ ] **v1.0.0 is latest release**: Confirmed in GitHub UI
- [ ] **install.sh defaults to v1.0.0**: Tested with `curl ... | sh`
- [ ] **Users downgrading successfully**: â‰¥20 reports of successful downgrade in Discord
- [ ] **Issue resolved for downgraded users**: No reports of original issue from v1.0.0 users
- [ ] **New installs get v1.0.0**: Tested on fresh VM

**Rollback Status**: âœ… SUCCESSFUL / âŒ FAILED / â³ IN PROGRESS
```

---

### Rollback Procedure: crates.io (Cannot Rollback)

**Problem**: crates.io does NOT support un-publishing or rollback

**Solutions**:

**Option 1: Yank the Release (Prevents new installs)**

```bash
# Yank v1.1.0-beta from crates.io
cargo yank --vers 1.1.0-beta caro

# Effect:
# - Users with v1.1.0-beta in Cargo.lock can still build
# - New `cargo install caro` will install latest non-yanked version (v1.0.0)
# - Cargo.toml with `caro = "1.1.0-beta"` will fail to resolve
```

**Option 2: Publish v1.1.1 Hotfix (Fix Forward)**

```bash
# If fix is quick (<1 hour), publish hotfix instead of rollback
cargo publish

# v1.1.1 becomes latest, users auto-upgrade
```

**Option 3: Update README.md on crates.io**

```markdown
# caro

âš ï¸ **WARNING: v1.1.0-beta has critical issues. Please use v1.0.0.**

Install stable version:
```bash
cargo install caro --version 1.0.0
```

---

### Rollback Procedure: Homebrew (Community-Maintained)

**caro is not yet on Homebrew (future: v1.2.0)**

When available:

```bash
# Revert Homebrew formula to v1.0.0
cd $(brew --repository homebrew/core)
git log --oneline -- Formula/caro.rb  # Find commit for v1.0.0
git revert <commit-hash-for-v1.1.0>
git push

# Users upgrade with:
brew upgrade caro  # Gets v1.0.0
```

---

## Recovery Scenarios

### Scenario 1: Crash on Startup (P0)

**Symptoms**:
- `caro --version` crashes immediately
- Users cannot run any caro commands
- Affects all platforms

**Impact**: CRITICAL (100% of users cannot use caro)

**Rollback Decision**: âœ… IMMEDIATE ROLLBACK (no discussion needed)

**Procedure**:
1. Execute GitHub rollback procedure (10 min)
2. Post emergency announcement (2 min)
3. Monitor for 1 hour (ensure users can downgrade)

**Expected Recovery Time**: 15 minutes (rollback) + 1 hour (user downgrades)

---

### Scenario 2: Safety Validation Bypass (P0 Security)

**Symptoms**:
- Safety validator fails to block `rm -rf /`
- Users report dangerous commands not caught
- Reproducible in testing

**Impact**: CRITICAL (user data at risk)

**Rollback Decision**: âœ… IMMEDIATE ROLLBACK + Security Advisory

**Procedure**:
1. STOP: Do NOT announce publicly yet (avoid weaponization)
2. Execute rollback silently (10 min)
3. Publish security advisory AFTER rollback complete
4. Notify affected users privately (if PII exposed)

**Expected Recovery Time**: 15 minutes (rollback) + security advisory publication

---

### Scenario 3: Platform-Specific Crash (macOS ARM only)

**Symptoms**:
- macOS ARM users: caro crashes on startup
- macOS Intel, Linux x86_64: Works fine
- 25% of user base affected (ARM Macs)

**Impact**: HIGH (significant user segment broken)

**Rollback Decision**: ðŸ¤” CONSIDER ROLLBACK vs. FIX FORWARD

**Decision Factors**:
- Can we fix in <1 hour? â†’ Fix forward (hotfix v1.1.1)
- Will fix take >4 hours? â†’ Rollback
- Do we have workaround? â†’ Document workaround, delay rollback decision

**Procedure (if rolling back)**:
1. Execute rollback (10 min)
2. Announce: "v1.1.0-beta has issues on macOS ARM. We've rolled back to v1.0.0. We'll fix and re-release."
3. Debug macOS ARM issue offline
4. Re-release v1.1.1 with fix (targeting macOS ARM specifically)

**Expected Recovery Time**: 15 minutes (rollback) + 4-8 hours (fix) + 1 hour (re-release)

---

### Scenario 4: Performance Regression (2x slower)

**Symptoms**:
- Command generation takes 2x longer than v1.0.0
- p95 latency: 1000ms (was 500ms)
- Affects embedded backend only

**Impact**: MEDIUM (frustrating but functional)

**Rollback Decision**: ðŸ¤” FIX FORWARD (not critical enough for rollback)

**Procedure**:
1. Acknowledge issue publicly: "We've identified a performance regression in v1.1.0-beta embedded backend. Investigating."
2. Profile the code (flamegraph, tracing)
3. Identify bottleneck (e.g., model loading on every query instead of caching)
4. Fix and release v1.1.1 hotfix within 24 hours

**Expected Recovery Time**: No rollback. Hotfix in 24 hours.

---

### Scenario 5: Data Corruption (Telemetry Database)

**Symptoms**:
- Users report telemetry database corruption
- `caro stats` crashes with "database malformed"
- Local data only (no remote data affected)

**Impact**: LOW (optional feature, local data only)

**Rollback Decision**: âŒ FIX FORWARD (data recovery + patch)

**Procedure**:
1. Provide data recovery script:
   ```bash
   # Delete corrupted database (users can opt-in)
   rm ~/.cache/caro/metrics.db
   caro stats  # Recreates empty database
   ```
2. Fix corruption bug in v1.1.1
3. Add database schema migration logic

**Expected Recovery Time**: Immediate workaround (delete DB) + hotfix in 48 hours

---

## Data Recovery

### User Data Types in caro

| Data Type | Location | Criticality | Backup Strategy |
|-----------|----------|-------------|-----------------|
| **Config** | `~/.config/caro/config.toml` | HIGH | User can manually backup |
| **Telemetry DB** | `~/.cache/caro/metrics.db` | LOW | Ephemeral (30-day retention) |
| **Command History** | `~/.cache/caro/history.db` | MEDIUM | User can export: `caro history export` |
| **Logs** | `~/.cache/caro/logs/` | LOW | Debug only, no user data |

---

### Data Recovery: Config File

**Scenario**: User's config.toml corrupted after upgrade

**Recovery Procedure**:
```bash
# Backup corrupted config
mv ~/.config/caro/config.toml ~/.config/caro/config.toml.bak

# Regenerate default config
caro config init

# Manually merge user settings from backup
# (No automated migration - user edits by hand)
```

**Prevention**:
- Always backup config before writing: `config.toml.bak`
- Validate config on load (fail gracefully if invalid)
- Provide `caro config validate` command

---

### Data Recovery: Telemetry Database

**Scenario**: metrics.db corrupted, `caro stats` crashes

**Recovery Procedure**:
```bash
# Option 1: Delete and start fresh (recommended)
rm ~/.cache/caro/metrics.db
caro stats  # Recreates empty database

# Option 2: Try SQLite recovery (advanced users)
sqlite3 ~/.cache/caro/metrics.db ".recover" > recovered.sql
mv ~/.cache/caro/metrics.db ~/.cache/caro/metrics.db.corrupted
sqlite3 ~/.cache/caro/metrics.db < recovered.sql
```

**Prevention**:
- Use SQLite transactions (atomic writes)
- Enable SQLite WAL mode (Write-Ahead Logging)
- Regular integrity checks: `PRAGMA integrity_check;`

---

### Data Migration: Forward Compatibility

**Problem**: v1.0.0 cannot read v1.1.0 data formats

**Solution**: Graceful degradation

```rust
pub fn load_config(path: &Path) -> Result<Config> {
    let content = fs::read_to_string(path)?;
    let config: Config = toml::from_str(&content)
        .or_else(|e| {
            // If parsing fails, try legacy format
            warn!("Failed to parse config (new format), trying legacy format");
            parse_legacy_config(&content)
        })?;

    Ok(config)
}
```

**Migration Strategy**:
- v1.1.0 writes new format, reads both old and new
- v1.0.0 ignores unknown fields in v1.1.0 config
- Database schema versions: `PRAGMA user_version = 2;`

---

## Communication During Rollback

### Rollback Announcement Template

**Channel**: Discord #announcements, Twitter, GitHub

**Template**:
```markdown
âš ï¸ **ROLLBACK NOTICE: Reverting caro to v1.0.0**

**What Happened**:
We've identified [issue description] in v1.1.0-beta that affects [percentage/description of users].

**Impact**:
- [Describe user-facing impact]
- [Severity: Critical / High / Medium]

**Action Required**:
If you upgraded to v1.1.0-beta, please downgrade to v1.0.0:

**Quick Install**:
```bash
curl -fsSL https://caro.sh/install.sh | sh
```

**Manual Downgrade**:
```bash
cargo install caro --version 1.0.0 --force
```

**Or download binaries**: https://github.com/username/caro/releases/tag/v1.0.0

**Timeline**:
- [Timestamp]: Issue detected
- [Timestamp]: Rollback initiated
- [Timestamp]: v1.0.0 marked as latest
- [Now]: Users can safely downgrade

**What's Next**:
- We're investigating the root cause
- A fix will be developed and tested thoroughly
- We'll communicate when v1.1.1 (or v1.2.0) is ready

**Questions?**
- Discord: #support
- GitHub: [Issue link]

We apologize for the disruption and appreciate your patience.

â€” caro Team
```

---

### Status Updates During Rollback

**Every 30 minutes during rollback**:

```markdown
**Rollback Status Update** ([HH:MM] UTC)

âœ… Completed:
- [x] v1.1.0-beta un-latested on GitHub
- [x] v1.0.0 marked as latest
- [x] install.sh reverted

â³ In Progress:
- [ ] Monitoring user downgrades (50/100 confirmed)

ðŸ“Š Metrics:
- Downgrade rate: 50% of v1.1.0 users
- New installs: Getting v1.0.0 âœ…
- Issue resolved: 90% of downgraded users

Next update in 30 minutes.
```

---

## Post-Rollback Analysis

### Rollback Post-Mortem Template

**File**: `.claude/releases/retrospectives/v1.1.0-rollback-YYYY-MM-DD.md`

```markdown
# Post-Mortem: v1.1.0-beta Rollback (YYYY-MM-DD)

## Summary

On [date] at [time] UTC, we rolled back v1.1.0-beta to v1.0.0 due to [issue].

## Timeline

**[HH:MM]**: Issue first reported by @username in Discord
**[HH:MM]**: Team confirmed reproducibility
**[HH:MM]**: Rollback decision made by Release Manager
**[HH:MM]**: Rollback initiated
**[HH:MM]**: v1.0.0 marked as latest on GitHub
**[HH:MM]**: Users notified via Discord, Twitter
**[HH:MM]**: Rollback verified successful
**[HH:MM]**: Post-mortem published

**Total Duration**: [X hours] from detection to resolution

## Impact

- **Users affected**: [percentage/number]
- **Severity**: Critical / High / Medium / Low
- **Downtime**: [X minutes] (time to rollback)
- **User actions required**: Downgrade to v1.0.0

## Root Cause

[Technical explanation of what went wrong]

**Why wasn't this caught in testing?**
[Honest explanation of testing gaps]

## What Went Well

âœ… [Positive action 1]
âœ… [Positive action 2]
âœ… [Positive action 3]

## What Could Have Been Better

âŒ [Mistake or gap 1]
âŒ [Mistake or gap 2]
âŒ [Mistake or gap 3]

## Action Items

To prevent similar issues:

| Action | Owner | Due Date | Status |
|--------|-------|----------|--------|
| [Action 1] | [Name] | [Date] | â³ In Progress |
| [Action 2] | [Name] | [Date] | â³ In Progress |
| [Action 3] | [Name] | [Date] | â³ In Progress |

## Lessons Learned

[Reflection on what the team learned]

## Updated Procedures

Based on this rollback, we've updated:
- [Document 1]: [Changes made]
- [Document 2]: [Changes made]

---

**Reviewed by**: [Team members]
**Approved by**: Release Manager, Engineering Lead
**Published**: [Date]
```

---

## Prevention Strategies

### 1. Enhanced Testing Before Release

**Add to Pre-Release Checklist**:
```markdown
- [ ] Test on ALL supported platforms (not just one)
- [ ] Test with FRESH installs (not just upgrades)
- [ ] Test with DEFAULT config (not just developer configs)
- [ ] Test with SLOW networks (simulate timeouts)
- [ ] Test with OFFLINE mode (embedded backend only)
```

---

### 2. Gradual Rollout (Progressive Deployment)

**Strategy**: Release to small percentage first

```markdown
Week 1, Day 1: 1% of users (early adopters)
Week 1, Day 2: 5% (if no critical issues)
Week 1, Day 3: 25%
Week 1, Day 4: 50%
Week 1, Day 5: 100%
```

**Benefit**: Catch issues before affecting all users

---

### 3. Feature Flags (Future: v1.2.0)

**Concept**: Deploy code, enable features gradually

```rust
pub struct FeatureFlags {
    pub new_static_matcher: bool,
    pub chain_of_thought_prompting: bool,
}

impl FeatureFlags {
    pub fn load() -> Self {
        Self {
            new_static_matcher: env::var("CARO_FF_NEW_MATCHER").is_ok(),
            chain_of_thought_prompting: env::var("CARO_FF_COT").is_ok(),
        }
    }
}

// Usage
if feature_flags.new_static_matcher {
    new_matcher.generate(query)
} else {
    legacy_matcher.generate(query)  // Fallback
}
```

**Benefit**: Instant rollback (toggle flag, no code deploy)

---

### 4. Canary Releases

**Concept**: Release to "canary" test users first

```markdown
Day 1: Release v1.1.0-beta to canary users (volunteers)
Day 2-3: Monitor for issues
Day 4: If stable, release to all users
```

**Canary Users**: Early adopters who opt-in to bleeding edge

---

### 5. Automated Rollback Triggers

**Future: Integrate with CI/CD**

```yaml
# .github/workflows/auto-rollback.yml
name: Auto-Rollback on Critical Failure

on:
  schedule:
    - cron: '*/5 * * * *'  # Every 5 minutes

jobs:
  check-metrics:
    runs-on: ubuntu-latest
    steps:
      - name: Check crash rate
        run: |
          CRASH_RATE=$(curl -s https://metrics.caro.sh/crash_rate)
          if [ "$CRASH_RATE" -gt 10 ]; then
            echo "Crash rate >10%, initiating auto-rollback"
            gh workflow run rollback.yml
          fi
```

---

## Document History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2026-01-08 | Engineering Lead + Release Manager | Initial comprehensive rollback & recovery procedures |

---

**End of Document**
