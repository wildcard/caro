name: "CLA Assistant"

on:
  issue_comment:
    types: [created]
  pull_request_target:
    types: [opened, synchronize, reopened]

permissions:
  actions: write
  contents: write
  pull-requests: write
  statuses: write

jobs:
  cla-check:
    runs-on: ubuntu-latest
    steps:
      - name: "CLA Assistant"
        if: (github.event.comment.body == 'recheck' || github.event.comment.body == 'I have read the CLA Document and I hereby sign the CLA') || github.event_name == 'pull_request_target'
        uses: contributor-assistant/github-action@v2.4.0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          # Use a Personal Access Token with 'repo' scope for private repos
          # PERSONAL_ACCESS_TOKEN: ${{ secrets.PERSONAL_ACCESS_TOKEN }}
        with:
          path-to-signatures: '.github/cla-signatures.json'
          path-to-document: 'https://github.com/wildcard/caro/blob/main/docs/legal/CLA.md'
          # Branch where signatures will be stored
          branch: 'cla-signatures'
          # Allowlist for bots and specific users
          allowlist: bot*,dependabot*,github-actions*

          # Message to post on PR when CLA is not signed
          custom-pr-sign-comment: |
            Thank you for your contribution to **caro**! ðŸŽ‰

            Before we can merge your pull request, we need you to sign our **Contributor License Agreement (CLA)**.

            ### How to Sign

            Please read our CLA here: [CLA.md](https://github.com/wildcard/caro/blob/main/docs/legal/CLA.md)

            Once you've read and agree to the terms, simply comment on this PR with:
            ```
            I have read the CLA Document and I hereby sign the CLA
            ```

            ### Alternative: Developer Certificate of Origin (DCO)

            If you prefer, you can use DCO instead by signing off your commits with:
            ```bash
            git commit -s -m "Your commit message"
            ```

            See [DCO.txt](https://github.com/wildcard/caro/blob/main/docs/legal/DCO.txt) for details.

            ---

            *Note: You only need to sign once. Your signature will cover all future contributions to caro.*

          # Message to post when CLA is signed
          custom-allsigned-prcomment: |
            **âœ… CLA Signed!**

            Thank you for signing the CLA! Your contribution can now be reviewed and merged. ðŸš€

          # Lock PR branch after merge to prevent signature removal
          lock-pullrequest-aftermerge: true

          # Signature verification
          use-dco-flag: false
