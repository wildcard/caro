---
import LearnLayout from './LearnLayout.astro';

interface Props {
  title: string;
  type: 'command' | 'trivia' | 'quote' | 'tip' | 'error';
  publishedAt: Date;
  socialText: string;
  hashtags: string[];
  source?: string;
}

const { title, type, publishedAt, socialText, hashtags, source } = Astro.props;

const typeInfo: Record<string, { color: string; icon: string; label: string }> = {
  command: { color: '#27ae60', icon: '>', label: 'Command of the Day' },
  trivia: { color: '#9b59b6', icon: '?', label: 'Did You Know?' },
  quote: { color: '#3498db', icon: '"', label: 'Unix Wisdom' },
  tip: { color: '#f39c12', icon: '!', label: 'Pro Tip' },
  error: { color: '#e74c3c', icon: 'x', label: 'Error Archaeology' }
};

const info = typeInfo[type] || typeInfo.tip;
---

<LearnLayout title={title} description={socialText}>
  <article class="daily-article">
    <header class="daily-header">
      <div class="type-badge" style={`background-color: ${info.color}`}>
        <span class="type-icon">{info.icon}</span>
        <span class="type-label">{info.label}</span>
      </div>

      <time class="date">
        {publishedAt.toLocaleDateString('en-US', {
          weekday: 'long',
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        })}
      </time>

      <h1>{title}</h1>
    </header>

    <div class="content">
      <slot />
    </div>

    <aside class="share-box">
      <h3>Share This</h3>
      <div class="social-preview">
        <p class="preview-text">{socialText}</p>
        <div class="hashtags">
          {hashtags.map(tag => (
            <span class="hashtag">#{tag}</span>
          ))}
        </div>
      </div>
      <div class="share-buttons">
        <a
          href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(socialText)}`}
          target="_blank"
          rel="noopener noreferrer"
          class="share-btn twitter"
        >
          Share on X
        </a>
        <button class="share-btn copy" onclick="navigator.clipboard.writeText(this.dataset.text)" data-text={socialText}>
          Copy Text
        </button>
      </div>
    </aside>

    {source && (
      <p class="source">Source: {source}</p>
    )}

    <nav class="daily-nav">
      <a href="/learn/daily" class="back-link">
        &larr; All Daily Picks
      </a>
    </nav>
  </article>
</LearnLayout>

<style>
  .daily-article {
    max-width: 700px;
    margin: 0 auto;
  }

  .daily-header {
    text-align: center;
    margin-bottom: 2rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid #e0e0e0;
  }

  .type-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.4rem 1rem;
    border-radius: 2rem;
    color: white;
    font-weight: 600;
    margin-bottom: 1rem;
  }

  .type-icon {
    font-family: monospace;
    font-size: 1.2rem;
  }

  .type-label {
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .date {
    display: block;
    color: #7f8c8d;
    font-size: 0.9rem;
    margin-bottom: 1rem;
  }

  .daily-header h1 {
    font-size: 2.2rem;
    color: #2c3e50;
    margin: 0;
    line-height: 1.3;
  }

  .content {
    font-size: 1.1rem;
    line-height: 1.8;
  }

  .content :global(h2) {
    margin-top: 2rem;
    color: #2c3e50;
  }

  .content :global(h3) {
    margin-top: 1.5rem;
    color: #2c3e50;
  }

  .content :global(pre) {
    background: #2c3e50;
    color: #ecf0f1;
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
  }

  .content :global(code) {
    background: #f8f9fa;
    padding: 0.15rem 0.3rem;
    border-radius: 0.2rem;
    font-size: 0.9em;
    color: #ff6b35;
  }

  .content :global(pre code) {
    background: transparent;
    padding: 0;
    color: inherit;
  }

  .share-box {
    margin-top: 2.5rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, #f8f9fa, #fff);
    border: 1px solid #e0e0e0;
    border-radius: 0.5rem;
  }

  .share-box h3 {
    margin: 0 0 1rem 0;
    color: #2c3e50;
    font-size: 1rem;
  }

  .social-preview {
    background: white;
    padding: 1rem;
    border-radius: 0.25rem;
    border: 1px solid #e0e0e0;
    margin-bottom: 1rem;
  }

  .preview-text {
    margin: 0 0 0.5rem 0;
    font-family: system-ui, -apple-system, sans-serif;
    font-size: 0.95rem;
    color: #2c3e50;
    white-space: pre-wrap;
  }

  .hashtags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .hashtag {
    color: #3498db;
    font-size: 0.85rem;
  }

  .share-buttons {
    display: flex;
    gap: 0.75rem;
  }

  .share-btn {
    padding: 0.5rem 1rem;
    border-radius: 0.25rem;
    font-size: 0.9rem;
    font-weight: 500;
    text-decoration: none;
    cursor: pointer;
    transition: all 0.2s;
  }

  .share-btn.twitter {
    background: #1da1f2;
    color: white;
    border: none;
  }

  .share-btn.twitter:hover {
    background: #0c8de4;
  }

  .share-btn.copy {
    background: white;
    color: #2c3e50;
    border: 1px solid #e0e0e0;
  }

  .share-btn.copy:hover {
    border-color: #ff6b35;
    color: #ff6b35;
  }

  .source {
    margin-top: 1.5rem;
    color: #7f8c8d;
    font-size: 0.9rem;
    font-style: italic;
  }

  .daily-nav {
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid #e0e0e0;
  }

  .back-link {
    color: #ff6b35;
    text-decoration: none;
    font-weight: 500;
  }

  .back-link:hover {
    text-decoration: underline;
  }
</style>
